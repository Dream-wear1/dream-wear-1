<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Analytics Dashboard - DreamWear</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .analytics-container {
            max-width: 1200px;
            margin: 120px auto 80px;
            padding: 0 20px;
        }
        
        .analytics-header {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .stat-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .visitors .stat-icon { color: #e74c3c; }
        .views .stat-icon { color: #3498db; }
        .orders .stat-icon { color: #27ae60; }
        .revenue .stat-icon { color: #f39c12; }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        
        .stat-period {
            color: #888;
            font-size: 0.9rem;
        }
        
        .charts-section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .recent-activity {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #eee;
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
        }
        
        .activity-visit { background: #e8f5e8; color: #27ae60; }
        .activity-cart { background: #fff3cd; color: #856404; }
        .activity-order { background: #d1ecf1; color: #0c5460; }
        
        .activity-details {
            flex: 1;
        }
        
        .activity-title {
            font-weight: bold;
            margin-bottom: 0.25rem;
        }
        
        .activity-time {
            color: #666;
            font-size: 0.9rem;
        }
        
        .refresh-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin: 1rem 0;
            transition: background 0.3s;
        }
        
        .refresh-btn:hover {
            background: #c0392b;
        }
        
        .github-analytics {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid #28a745;
            margin-bottom: 2rem;
        }
        
        .github-analytics h3 {
            color: #28a745;
            margin-bottom: 1rem;
        }
        
        .github-step {
            background: white;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
        
        .external-analytics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .analytics-option {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .analytics-option h4 {
            color: #333;
            margin-bottom: 1rem;
        }
        
        .analytics-option .pros {
            background: #e8f5e8;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        
        .analytics-option .pros h5 {
            color: #27ae60;
            margin-bottom: 0.5rem;
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <a href="index.html" style="text-decoration: none; color: inherit;">
                        <h2><i class="fas fa-moon"></i> DreamWear</h2>
                    </a>
                </div>
                
                <div class="nav-menu">
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">Back to Store</a>
                        </li>
                        <li class="nav-item">
                            <a href="orders.html" class="nav-link">Orders</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="analytics-container">
        <div class="analytics-header">
            <h1><i class="fas fa-chart-line"></i> Website Analytics Dashboard</h1>
            <p>Track your website performance and visitor behavior</p>
            <button class="refresh-btn" onclick="refreshStats()">
                <i class="fas fa-sync-alt"></i> Refresh Data
            </button>
        </div>

        <!-- Current Statistics -->
        <div class="stats-grid">
            <div class="stat-card visitors">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-number" id="total-visitors">0</div>
                <div class="stat-label">Total Visitors</div>
                <div class="stat-period">All time</div>
            </div>
            
            <div class="stat-card views">
                <div class="stat-icon">
                    <i class="fas fa-eye"></i>
                </div>
                <div class="stat-number" id="total-views">0</div>
                <div class="stat-label">Page Views</div>
                <div class="stat-period">All time</div>
            </div>
            
            <div class="stat-card orders">
                <div class="stat-icon">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <div class="stat-number" id="total-orders">0</div>
                <div class="stat-label">Orders Placed</div>
                <div class="stat-period">All time</div>
            </div>
            
            <div class="stat-card revenue">
                <div class="stat-icon">
                    <i class="fas fa-dollar-sign"></i>
                </div>
                <div class="stat-number" id="total-revenue">PKR 0</div>
                <div class="stat-label">Total Revenue</div>
                <div class="stat-period">All time</div>
            </div>
        </div>

        <!-- GitHub Analytics Guide -->
        <div class="github-analytics">
            <h3><i class="fab fa-github"></i> GitHub Pages Analytics</h3>
            <p>For more detailed analytics on your GitHub-hosted website:</p>
            
            <div class="github-step">
                <strong>Step 1:</strong> Go to your repository: <code>https://github.com/amaarkhan/e-commerce-website</code>
            </div>
            
            <div class="github-step">
                <strong>Step 2:</strong> Click on the "Insights" tab at the top
            </div>
            
            <div class="github-step">
                <strong>Step 3:</strong> Select "Traffic" from the left sidebar
            </div>
            
            <div class="github-step">
                <strong>What you'll see:</strong> Visitor count, page views, and referral sources for the last 14 days
            </div>
        </div>

        <!-- External Analytics Options -->
        <div class="external-analytics">
            <div class="analytics-option">
                <h4><i class="fab fa-google"></i> Google Analytics</h4>
                <p>Most comprehensive analytics solution</p>
                <div class="pros">
                    <h5>✅ Benefits:</h5>
                    <ul style="text-align: left;">
                        <li>Real-time visitor tracking</li>
                        <li>Detailed user behavior</li>
                        <li>E-commerce conversion tracking</li>
                        <li>Mobile vs desktop analytics</li>
                        <li>Geographic visitor data</li>
                    </ul>
                </div>
                <p><strong>Setup:</strong> Add tracking code to your index.html (already added - just replace GA_TRACKING_ID)</p>
            </div>
            
            <div class="analytics-option">
                <h4><i class="fas fa-chart-bar"></i> StatCounter</h4>
                <p>Simple visitor counter</p>
                <div class="pros">
                    <h5>✅ Benefits:</h5>
                    <ul style="text-align: left;">
                        <li>Easy setup</li>
                        <li>Basic visitor count</li>
                        <li>Country statistics</li>
                        <li>Free plan available</li>
                    </ul>
                </div>
                <p><strong>Setup:</strong> Sign up at statcounter.com and add their code</p>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="recent-activity">
            <h3><i class="fas fa-clock"></i> Recent Activity</h3>
            <div id="activity-list">
                <!-- Activity items will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script src="visitor-counter.js"></script>
    <script>
        // Load and display analytics
        function loadAnalytics() {
            // Get visitor stats
            const stats = getVisitorStats();
            document.getElementById('total-visitors').textContent = stats.totalVisitors;
            document.getElementById('total-views').textContent = stats.totalVisits;
            
            // Get order stats
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            document.getElementById('total-orders').textContent = orders.length;
            
            // Calculate revenue
            const totalRevenue = orders.reduce((sum, order) => sum + (order.totals?.total || 0), 0);
            document.getElementById('total-revenue').textContent = `PKR ${totalRevenue.toFixed(2)}`;
            
            // Load recent activity
            loadRecentActivity();
        }
        
        function loadRecentActivity() {
            const visits = JSON.parse(localStorage.getItem('siteVisits') || '[]');
            const events = JSON.parse(localStorage.getItem('ecommerceEvents') || '[]');
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            
            // Combine and sort all activities
            const activities = [
                ...visits.slice(-5).map(visit => ({
                    type: 'visit',
                    time: visit.date,
                    details: `Page visit: ${visit.page}`
                })),
                ...events.slice(-5).map(event => ({
                    type: event.type,
                    time: event.timestamp,
                    details: `${event.type}: ${event.data.product_name || 'Action performed'}`
                })),
                ...orders.slice(-3).map(order => ({
                    type: 'order',
                    time: order.date,
                    details: `Order ${order.orderNumber} - PKR ${order.totals.total.toFixed(2)}`
                }))
            ].sort((a, b) => new Date(b.time) - new Date(a.time)).slice(0, 10);
            
            const activityList = document.getElementById('activity-list');
            activityList.innerHTML = '';
            
            if (activities.length === 0) {
                activityList.innerHTML = '<p style="text-align: center; color: #666;">No recent activity</p>';
                return;
            }
            
            activities.forEach(activity => {
                const div = document.createElement('div');
                div.className = 'activity-item';
                
                let iconClass = 'fas fa-eye';
                let activityClass = 'activity-visit';
                
                if (activity.type === 'add_to_cart') {
                    iconClass = 'fas fa-cart-plus';
                    activityClass = 'activity-cart';
                } else if (activity.type === 'order' || activity.type === 'purchase') {
                    iconClass = 'fas fa-shopping-bag';
                    activityClass = 'activity-order';
                }
                
                div.innerHTML = `
                    <div class="activity-icon ${activityClass}">
                        <i class="${iconClass}"></i>
                    </div>
                    <div class="activity-details">
                        <div class="activity-title">${activity.details}</div>
                        <div class="activity-time">${new Date(activity.time).toLocaleString()}</div>
                    </div>
                `;
                
                activityList.appendChild(div);
            });
        }
        
        function refreshStats() {
            loadAnalytics();
            
            // Show refresh animation
            const btn = document.querySelector('.refresh-btn i');
            btn.style.animation = 'spin 1s linear';
            setTimeout(() => {
                btn.style.animation = '';
            }, 1000);
        }
        
        // Load analytics when page loads
        document.addEventListener('DOMContentLoaded', loadAnalytics);
        
        // Add CSS animation for refresh button
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
